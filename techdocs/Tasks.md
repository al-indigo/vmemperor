# Задачи Xen (tasks)



 См.  `XenObject.process_event` (`xenadapter/xenobject.py`)
 
 
Когда задачи начинают фигурировать в поле `current_operations` какого-либо объекта Xen, ИЛИ вызываются из нашего API XenObject, 
к телу задачи добавляются поля `object_ref`, `object_type` и `access`. При этом, права задачи выставляются таким образом, что доступ к ней имеют те пользователи, которые имеют соответствующий доступ к объекту-родоначальнику задачи (все классы прав доступа являются надмножеством классов задач Xen. Например, если пользователь имеет право доступа `start` для  конкретной `VM`, он может отслеживать все задачи класса `start` для этой `VM`)




Если задача не была записана исходя из того, что она есть в `current_operations`, она игнорируется классом `Task` при обработке события класса `task`. См. `Task.process_record` (`xenadapter/task.py`)

Однако, когда задача создается нами (через вызов Async XAPI), мы добавляем ее в таблицу задач в момент создания с полем `vmemperor=True` для того, чтобы уничтожить ее когда она завершится.
См. `XenObject.__getattr__` (создание) и `Task.process_event` (уничтожение)

## NB!!
Для того, чтобы записывать, кто вызывал асинхронную мутацию, не вызывайте async методы класса XenObject напрямую. Вместо этого, см. класс AsyncMutationMethod
 